(function(a){function h(a){var b=a.multiple,c=[],d;if(!b)return a.value;for(d=a.getElementsByTagName("option"),i=0,l=d.length;i<l;i++){if(d[i].selected)c.push(d[i].value)}return c}function g(a){if(a.disabled)return null;switch(a.nodeName){case"INPUT":case"TEXTAREA":switch(a.type.toLowerCase()){case"radio":case"checkbox":if(a.checked)return a.value;break;case"button":case"reset":case"submit":case"image":return"";break;default:return a.value;break}break;case"SELECT":return h(a);break;default:break}return null}function f(a,b){if(a.name&&a.name!="")return a.name;else if(b&&a.id&&a.id!="")return a.id;else return""}function e(a,b,c){var e,h,i,j=f(a,c);e=b&&b(a);if(e&&e.name){i=[e]}else if(j!=""&&a.nodeName.match(/INPUT|TEXTAREA/i)){h=g(a);i=[{name:j,value:h}]}else if(j!=""&&a.nodeName.match(/SELECT/i)){h=g(a);i=[{name:j.replace(/\[\]$/,""),value:h}]}else{i=d(a,b,c)}return i}function d(a,b,c){var d=[],f=a.firstChild,g,h,i;while(f){d=d.concat(e(f,b,c));f=f.nextSibling}return d}function c(a,b,c){var f=e(a,b,c);return f.length>0?f:d(a,b,c)}function b(a,b,c){var d={},e={},f,g,h,i,j,k,l,m,n,o,p,q,r;for(f=0;f<a.length;f++){j=a[f].value;if(b&&(j===""||j===null))continue;q=a[f].name;r=q.split(c);k=[];l=d;m="";for(g=0;g<r.length;g++){p=r[g].split("][");if(p.length>1){for(h=0;h<p.length;h++){if(h==0){p[h]=p[h]+"]"}else if(h==p.length-1){p[h]="["+p[h]}else{p[h]="["+p[h]+"]"}o=p[h].match(/([a-z_]+)?\[([a-z_][a-z0-9]+?)\]/i);if(o){for(i=1;i<o.length;i++){if(o[i])k.push(o[i])}}else{k.push(p[h])}}}else k=k.concat(p)}for(g=0;g<k.length;g++){p=k[g];if(p.indexOf("[]")>-1&&g==k.length-1){n=p.substr(0,p.indexOf("["));m+=n;if(!l[n])l[n]=[];l[n].push(j)}else if(p.indexOf("[")>-1){n=p.substr(0,p.indexOf("["));o=p.replace(/(^([a-z_]+)?\[)|(\]$)/gi,"");m+="_"+n+"_"+o;if(!e[m])e[m]={};if(n!=""&&!l[n])l[n]=[];if(g==k.length-1){if(n==""){l.push(j);e[m][o]=l[l.length-1]}else{l[n].push(j);e[m][o]=l[n][l[n].length-1]}}else{if(!e[m][o]){if(/^[a-z_]+\[?/i.test(k[g+1]))l[n].push({});else l[n].push([]);e[m][o]=l[n][l[n].length-1]}}l=e[m][o]}else{m+=p;if(g<k.length-1){if(!l[p])l[p]={};l=l[p]}else{l[p]=j}}}}return d}a.form2object=function(a,d,e,f,g){if(typeof e=="undefined"||e==null)e=true;if(typeof d=="undefined"||d==null)d=".";if(arguments.length<5)g=false;a=typeof a=="string"?document.getElementById(a):a;var h=[],i,j=0;if(a.constructor==Array||typeof NodeList!="undefined"&&a.constructor==NodeList){while(i=a[j++]){h=h.concat(c(i,f,g))}}else{h=c(a,f,g)}return b(h,e,d)};window.form2json=window.form2object})(this)
